var e=Symbol.for("immer-nothing"),t=Symbol.for("immer-draftable"),n=Symbol.for("immer-state");function r(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var o=Object,i=o.getPrototypeOf,s="constructor",c="prototype",a="configurable",u="enumerable",_="writable",f="value",l=e=>!!e&&!!e[n];function p(e){return!!e&&(y(e)||P(e)||!!e[t]||!!e[s]?.[t]||w(e)||z(e))}var d=o[c][s].toString(),h=new WeakMap;function y(e){if(!e||!k(e))return!1;const t=i(e);if(null===t||t===o[c])return!0;const n=o.hasOwnProperty.call(t,s)&&t[s];if(n===Object)return!0;if(!F(n))return!1;let r=h.get(n);return void 0===r&&(r=Function.toString.call(n),h.set(n,r)),r===d}function g(e,t,n=!0){if(0===v(e)){(n?Reflect.ownKeys(e):o.keys(e)).forEach(n=>{t(n,e[n],e)})}else e.forEach((n,r)=>t(r,n,e))}function v(e){const t=e[n];return t?t.type_:P(e)?1:w(e)?2:z(e)?3:0}var S=(e,t,n=v(e))=>2===n?e.has(t):o[c].hasOwnProperty.call(e,t),m=(e,t,n=v(e))=>2===n?e.get(t):e[t],b=(e,t,n,r=v(e))=>{2===r?e.set(t,n):3===r?e.add(n):e[t]=n};var P=Array.isArray,w=e=>e instanceof Map,z=e=>e instanceof Set,k=e=>"object"==typeof e,F=e=>"function"==typeof e,O=e=>"boolean"==typeof e,C=e=>e.copy_||e.base_,D=e=>e.modified_?e.copy_:e.base_;function I(e,t){if(w(e))return new Map(e);if(z(e))return new Set(e);if(P(e))return Array[c].slice.call(e);const r=y(e);if(!0===t||"class_only"===t&&!r){const t=o.getOwnPropertyDescriptors(e);delete t[n];let r=Reflect.ownKeys(t);for(let n=0;n<r.length;n++){const o=r[n],i=t[o];!1===i[_]&&(i[_]=!0,i[a]=!0),(i.get||i.set)&&(t[o]={[a]:!0,[_]:!0,[u]:i[u],[f]:e[o]})}return o.create(i(e),t)}{const t=i(e);if(null!==t&&r)return{...e};const n=o.create(t);return o.assign(n,e)}}function M(e,t=!1){return A(e)||l(e)||!p(e)||(v(e)>1&&o.defineProperties(e,{set:x,add:x,clear:x,delete:x}),o.freeze(e),t&&g(e,(e,t)=>{M(t,!0)},!1)),e}var x={[f]:function(){r(2)}};function A(e){return null===e||!k(e)||o.isFrozen(e)}var N="MapSet",R="Patches",U={};function E(e){const t=U[e];return t||r(0),t}var K,L=()=>K;function j(e,t){t&&(e.patchPlugin_=E(R),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function W(e){X(e),e.drafts_.forEach(q),e.drafts_=null}function X(e){e===K&&(K=e.parent_)}var $=e=>{return K={drafts_:[],parent_:K,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:(t=N,U[t]?E(N):void 0)};var t};function q(e){const t=e[n];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function B(t,o){o.unfinalizedDrafts_=o.drafts_.length;const i=o.drafts_[0];if(void 0!==t&&t!==i){i[n].modified_&&(W(o),r(4)),p(t)&&(t=G(o,t));const{patchPlugin_:e}=o;e&&e.generateReplacementPatches_(i[n].base_,t,o)}else t=G(o,i);return function(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&M(t,n)}(o,t,!0),W(o),o.patches_&&o.patchListener_(o.patches_,o.inversePatches_),t!==e?t:void 0}function G(e,t){if(A(t))return t;const r=t[n];if(!r){return Y(t,e.handledSet_,e)}if(!J(r,e))return t;if(!r.modified_)return r.base_;if(!r.finalized_){const{callbacks_:t}=r;if(t)for(;t.length>0;){t.pop()(e)}V(r,e)}return r.copy_}function H(e){e.finalized_=!0,e.scope_.unfinalizedDrafts_--}var J=(e,t)=>e.scope_===t,Q=[];function T(e,t,n,r){const o=C(e),i=e.type_;if(void 0!==r){if(m(o,r,i)===t)return void b(o,r,n,i)}if(!e.draftLocations_){const t=e.draftLocations_=new Map;g(o,(e,n)=>{if(l(n)){const r=t.get(n)||[];r.push(e),t.set(n,r)}})}const s=e.draftLocations_.get(t)??Q;for(const c of s)b(o,c,n,i)}function V(e,t){if(e.modified_&&!e.finalized_&&(3===e.type_||(e.assigned_?.size??0)>0)){const{patchPlugin_:n}=t;if(n){const r=n.getPath(e);r&&n.generatePatches_(e,r,t)}H(e)}}function Y(e,t,r){return!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1||l(e)||t.has(e)||!p(e)||A(e)||(t.add(e),g(e,(o,i)=>{if(l(i)){const t=i[n];if(J(t,r)){const n=D(t);b(e,o,n,e.type_),H(t)}}else p(i)&&Y(i,t,r)})),e}var Z={get(e,t){if(t===n)return e;const r=C(e);if(!S(r,t,e.type_))return function(e,t,n){const r=ne(t,n);return r?f in r?r[f]:r.get?.call(e.draft_):void 0}(e,r,t);const o=r[t];if(e.finalized_||!p(o))return o;if(o===te(e.base_,t)){oe(e);const n=1===e.type_?+t:t,r=ie(e.scope_,o,e,n);return e.copy_[n]=r}return o},has:(e,t)=>t in C(e),ownKeys:e=>Reflect.ownKeys(C(e)),set(e,t,r){const o=ne(C(e),t);if(o?.set)return o.set.call(e.draft_,r),!0;if(!e.modified_){const o=te(C(e),t),c=o?.[n];if(c&&c.base_===r)return e.copy_[t]=r,e.assigned_.set(t,!1),!0;if(((i=r)===(s=o)?0!==i||1/i==1/s:i!=i&&s!=s)&&(void 0!==r||S(e.base_,t,e.type_)))return!0;oe(e),re(e)}var i,s;return e.copy_[t]===r&&(void 0!==r||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_.set(t,!0),function(e,t,r){const{scope_:o}=e;if(l(r)){const i=r[n];J(i,o)&&i.callbacks_.push(function(){oe(e);const n=D(i);T(e,r,n,t)})}else p(r)&&e.callbacks_.push(function(){const n=C(e);m(n,t,e.type_)===r&&o.drafts_.length>1&&!0===(e.assigned_.get(t)??!1)&&e.copy_&&Y(m(e.copy_,t,e.type_),o.handledSet_,o)})}(e,t,r)),!0},deleteProperty:(e,t)=>(oe(e),void 0!==te(e.base_,t)||t in e.base_?(e.assigned_.set(t,!1),re(e)):e.assigned_.delete(t),e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){const n=C(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{[_]:!0,[a]:1!==e.type_||"length"!==t,[u]:r[u],[f]:n[t]}:r},defineProperty(){r(11)},getPrototypeOf:e=>i(e.base_),setPrototypeOf(){r(12)}},ee={};function te(e,t){const r=e[n];return(r?C(r):e)[t]}function ne(e,t){if(!(t in e))return;let n=i(e);for(;n;){const e=Object.getOwnPropertyDescriptor(n,t);if(e)return e;n=i(n)}}function re(e){e.modified_||(e.modified_=!0,e.parent_&&re(e.parent_))}function oe(e){e.copy_||(e.assigned_=new Map,e.copy_=I(e.base_,e.scope_.immer_.useStrictShallowCopy_))}g(Z,(e,t)=>{ee[e]=function(){const e=arguments;return e[0]=e[0][0],t.apply(this,e)}}),ee.deleteProperty=function(e,t){return ee.set.call(this,e,t,void 0)},ee.set=function(e,t,n){return Z.set.call(this,e[0],t,n,e[0])};function ie(e,t,n,r){const[o,i]=w(t)?E(N).proxyMap_(t,n):z(t)?E(N).proxySet_(t,n):function(e,t){const n=P(e),r={type_:n?1:0,scope_:t?t.scope_:L(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let o=r,i=Z;n&&(o=[r],i=ee);const{revoke:s,proxy:c}=Proxy.revocable(o,i);return r.draft_=c,r.revoke_=s,[c,r]}(t,n);return(n?.scope_??L()).drafts_.push(o),i.callbacks_=n?.callbacks_??[],i.key_=r,n&&void 0!==r?function(e,t,n){e.callbacks_.push(function(r){const o=t;if(!o||!J(o,r))return;r.mapSetPlugin_?.fixSetContents(o);const i=D(o);T(e,o.draft_??o,i,n),V(o,r)})}(n,i,r):i.callbacks_.push(function(e){e.mapSetPlugin_?.fixSetContents(i);const{patchPlugin_:t}=e;i.modified_&&t&&t.generatePatches_(i,[],e)}),o}function se(e){if(!p(e)||A(e))return e;const t=e[n];let r,o=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=I(e,t.scope_.immer_.useStrictShallowCopy_),o=t.scope_.immer_.shouldUseStrictIteration()}else r=I(e,!0);return g(r,(e,t)=>{b(r,e,se(t))},o),t&&(t.finalized_=!1),r}var ce=(new class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(t,n,o)=>{if(F(t)&&!F(n)){const e=n;n=t;const r=this;return function(t=e,...o){return r.produce(t,e=>n.call(this,e,...o))}}let i;if(F(n)||r(6),void 0===o||F(o)||r(7),p(t)){const e=$(this),r=ie(e,t,void 0);let s=!0;try{i=n(r),s=!1}finally{s?W(e):X(e)}return j(e,o),B(i,e)}if(!t||!k(t)){if(i=n(t),void 0===i&&(i=t),i===e&&(i=void 0),this.autoFreeze_&&M(i,!0),o){const e=[],n=[];E(R).generateReplacementPatches_(t,i,{patches_:e,inversePatches_:n}),o(e,n)}return i}r(1)},this.produceWithPatches=(e,t)=>{if(F(e))return(t,...n)=>this.produceWithPatches(t,t=>e(t,...n));let n,r;return[this.produce(e,t,(e,t)=>{n=e,r=t}),n,r]},O(t?.autoFreeze)&&this.setAutoFreeze(t.autoFreeze),O(t?.useStrictShallowCopy)&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),O(t?.useStrictIteration)&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(e){p(e)||r(8),l(e)&&(e=function(e){l(e)||r(10);return se(e)}(e));const t=$(this),o=ie(t,e,void 0);return o[n].isManual_=!0,X(t),o}finishDraft(e,t){const o=e&&e[n];o&&o.isManual_||r(9);const{scope_:i}=o;return j(i,t),B(void 0,i)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));const r=E(R).applyPatches_;return l(e)?r(e,t):this.produce(e,e=>r(e,t))}}).produce;export{l as a,p as i,ce as p};
